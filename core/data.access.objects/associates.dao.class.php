<?php/*		Clase de métodos de inserción, modificación, eliminación y consulta sobre la tabla carreras * * @author Nelson D. Garzón M.	*/@session_start();include_once(dirname(__FILE__) . '/../data.bases/connection.mysql.class.php');include_once(dirname(__FILE__) . '/audit.dao.class.php');class associates {    private $conn;	private $audit;        function associates()    {        $this->conn = new connection();		$this->audit = new audit();		    }	function get_all_count_associates()    {        $record_set = $this->conn->db->Execute('SELECT COUNT(*) FROM carrera_semestre_materia');        if($record_set != false)        {            return $record_set;        }  else {            return null;        }    }		function getId($career, $semester, $subject)    {        $record_set = $this->conn->db->Execute('SELECT id FROM carrera_semestre_materia WHERE carrera = ? AND semestre = ? AND materia = ? ', array($career, $semester, $subject));        if($record_set != false)        {            return $record_set->fields[0];        }  else {            return 0;        }    }	    function get_all_associates($order, $index, $page)    {        $record_set = $this->conn->db->Execute('SELECT * FROM carrera_semestre_materia ORDER BY '.$order.' LIMIT '.$index.','.$page);        if($record_set != false)        {            return $record_set;        }  else {            return null;        }    }		function get_all_associates_list()    {        $record_set = $this->conn->db->Execute("SELECT csm.id, CONCAT(c.nombre,'/',s.nombre,'/',m.nombre) as relacion FROM carrera_semestre_materia csm INNER JOIN carrera c 												ON csm.carrera = c.id INNER JOIN semestre s ON csm.semestre = s.id INNER JOIN materia m ON csm.materia = m.id ORDER BY csm.carrera, csm.semestre, csm.materia ASC");        if($record_set != false)        {            return $record_set;        }  else {            return null;        }    }		function get_associate($career, $semester, $subject)    {		$record_set = $this->conn->db->Execute('SELECT * FROM carrera_semestre_materia WHERE carrera = ? and semestre = ? and materia = ? ', array($career, $semester, $subject));			        if($record_set != false)        {            return $record_set;        }  else {            return null;        }     }        function get_associate_search($career = "", $order, $index, $page)    {		if(!empty($career)){			$record_set = $this->conn->db->Execute('SELECT csm.* FROM carrera_semestre_materia csm INNER JOIN carrera c on csm.carrera = c.id WHERE c.nombre LIKE ? ORDER BY '.$order.' LIMIT '.$index.','.$page, array("%".$career."%"));		}else{			$record_set = $this->conn->db->Execute('SELECT * FROM carrera_semestre_materia ORDER BY '.$order.' LIMIT '.$index.','.$page);		}        if($record_set != false)        {            return $record_set;        }  else {            return null;        }     }       function insert_associate($career, $semester, $subject)    {		$this->audit->register_audit(3, 'INSERT INTO carrera_semestre_materia(carrera, semestre, materia) VALUES(?,?,?)', $_SESSION['id']);        return $this->conn->db->Execute('INSERT INTO carrera_semestre_materia(carrera, semestre, materia) VALUES(?,?,?) ', 			   array($career, $semester, $subject));    }		function update_associate($id, $career, $semester, $subject)    {		$this->audit->register_audit(3, 'UPDATE carrera_semestre_materia SET carrera = ?, semestre = ?, materia = ? WHERE id = ?', $_SESSION['id']);        return $this->conn->db->Execute('UPDATE carrera_semestre_materia SET carrera = ?, semestre = ?, materia = ? WHERE id = ? ', 			   array($career, $semester, $subject, $id));    }        function delete_associate($id)    {		$this->audit->register_audit(3, 'DELETE FROM carrera_semestre_materia WHERE id = ?', $_SESSION['id']);        return $this->conn->db->Execute('DELETE FROM carrera_semestre_materia WHERE id = ?', array($id));    }}	?>